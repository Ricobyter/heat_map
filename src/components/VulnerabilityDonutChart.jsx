import { PieChart, Pie, Cell, Tooltip, Legend } from 'recharts';

const districtData = {
  Low: ['Masaurhi', 'Pandarak', 'Sampatchak', 'Bikram', 'Dulhin Bazar'],
  Medium: ['Dhanarua', 'Fatwah', 'Bihta', 'Punpun'],
  High: ['Naubatpur','Maner','Barh','Athmalgola','Belchhi','Khusrupur','Ghoswari','Paliganj','Bakhtiyarpur','Mokama','Patna Sadar','Daniyawan','Danapur','Phulwari Sharif']
};

const CHART_DATA = [
  { name: 'Low', value: districtData.Low.length, color: '#10b981' },
  { name: 'Medium', value: districtData.Medium.length, color: '#fbbf24' },
  { name: 'High', value: districtData.High.length, color: '#ef4444' }
];

const CustomTooltip = ({ active, payload }) => {
  if (active && payload && payload.length) {
    const cat = payload[0].name;
    return (
      <div className="bg-white border rounded shadow p-2 text-xs max-w-[250px]">
        <div className="font-bold mb-1">{cat} Vulnerability</div>
        <div>
          {districtData[cat].join(', ')}
        </div>
      </div>
    );
  }
  return null;
};

export default function VulnerabilityDonutChart() {
  return (
    <div className="w-full flex items-center justify-center">
      <PieChart width={210} height={210}>
        <Pie
          data={CHART_DATA}
          dataKey="value"
          nameKey="name"
          cx="50%"
          cy="50%"
          innerRadius={30}
          outerRadius={70}
          paddingAngle={3}
        >
          {CHART_DATA.map((entry, idx) => (
            <Cell key={`cell-${idx}`} fill={entry.color} />
          ))}
        </Pie>
        <Tooltip content={<CustomTooltip />} />
        <Legend verticalAlign="bottom" iconType="circle" />
      </PieChart>
    </div>
  );
}
